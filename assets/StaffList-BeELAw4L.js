import{u as he,w as K,r as q,j as e,C as se,P as z}from"./index-BqPi6Scg.js";import{a as h}from"./vendor-CMvHcHbC.js";import{a as ve,u as ye}from"./redux-IAqEd8mO.js";import{c as g,a as L,b as T}from"./index.esm-CgghJxql.js";import{u as oe}from"./useLocale-C1tm0iYC.js";import{f as _e,h as ne,s as me,t as be,v as Se,w as Ce,x as Ne,y as xe,z as we,A as ae,B as te,c as Fe,a as ke,D as Te,E as re,C as A,e as Re,l as Ee,F as De,G as Le,H as Ae,I as $,J as Ie,K as Oe,L as Pe}from"./DefaultLayout-DhHfHE_z.js";import{b as S,c as f,a as Z}from"./CRow-D_28WzSY.js";import{c as I,d as O,b as P,a as Me}from"./CForm-CHhLrB3s.js";import{C as ce}from"./CCardHeader-vqvVWZ-H.js";import{c as je,a as He}from"./cil-save-CuPF9_Mc.js";import{C as X}from"./CInputGroup-Dx0YLWSn.js";import{C as le}from"./CInputGroupText-D8xN2KBJ.js";import{c as fe}from"./cil-user-Ddrdy7PS.js";import{C as ie,a as Q,b as Y,c as w,d as u,e as ee,f as j}from"./CTable-CH1g_BFA.js";import{c as Be}from"./cil-options-sHCm5Gxk.js";import"./navPaths-CZBFaHdh.js";var qe=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M19.409,431.289v41.468a24.124,24.124,0,0,0,24.1,24.1H76.877A149.445,149.445,0,0,0,183.25,452.792L383.966,252.075l55.846,56.069,22.671-22.582-55.889-56.114,1.287-1.288-.021-.02,63.287-63.287a84.853,84.853,0,0,0,0-120l-4-4a84.852,84.852,0,0,0-120,0l-64.326,64.326L230.947,53.1,208.275,75.68,260.387,128,63.471,324.916A149.449,149.449,0,0,0,19.409,431.289ZM369.774,63.48a52.854,52.854,0,0,1,74.747,0l4,4a52.913,52.913,0,0,1,0,74.745L387.147,203.6,308.4,124.853Zm-85.72,86.107,78.573,78.573-69.176,69.176v-.483H136.788ZM104.788,328.853H261.935L160.623,430.165a117.662,117.662,0,0,1-83.746,34.688H51.409V431.289A117.664,117.664,0,0,1,86.1,347.543Z' class='ci-primary'/>"],ue=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M449.366,89.648l-.685-.428L362.088,46.559,268.625,171.176l43,57.337a88.529,88.529,0,0,1-83.115,83.114l-57.336-43L46.558,362.088l42.306,85.869.356.725.429.684a25.085,25.085,0,0,0,21.393,11.857h22.344A327.836,327.836,0,0,0,461.222,133.386V111.041A25.084,25.084,0,0,0,449.366,89.648Zm-20.144,43.738c0,163.125-132.712,295.837-295.836,295.837h-18.08L87,371.76l84.18-63.135,46.867,35.149h5.333a120.535,120.535,0,0,0,120.4-120.4v-5.333l-35.149-46.866L371.759,87l57.463,28.311Z' class='ci-primary'/>"];const pe=({staff:o=null,onClose:_,onSuccess:n})=>{const{business:r}=he(),{t}=oe(),[m,C]=h.useState(!1),[M,x]=h.useState(""),[R,H]=h.useState([]),[E,N]=h.useState(!0),[c,p]=h.useState({first_name:"",last_name:"",email:"",phone:"",role:q.junior_employee,commission_rate:10,is_available_for_booking:!0,working_hours:K,service_ids:[]}),[v,D]=h.useState(K);h.useEffect(()=>{V()},[r==null?void 0:r.id]),h.useEffect(()=>{if(o){const a=o.employee_services?o.employee_services.map(i=>i.service_id):[];p({first_name:o.first_name||"",last_name:o.last_name||"",email:o.email||"",phone:o.phone||"",role:o.role||q.junior_employee,commission_rate:o.commission_rate||0,is_available_for_booking:o.is_available_for_booking!==!1,working_hours:o.working_hours||K,service_ids:a}),D(o.working_hours||K)}},[o]);const V=async()=>{if(r!=null&&r.id){N(!0);try{const{data:a,error:i}=await _e(r.id);i?console.error("Error loading services:",i):H(a||[])}catch(a){console.error("Error loading services:",a)}finally{N(!1)}}},b=(a,i)=>{p(s=>({...s,[a]:i}))},G=a=>{p(i=>{const s=i.service_ids.includes(a)?i.service_ids.filter(d=>d!==a):[...i.service_ids,a];return{...i,service_ids:s}})},F=(a,i,s)=>{const d={...v,[a]:{...v[a],[i]:s}};D(d),p(y=>({...y,working_hours:d}))},k=()=>c.first_name.trim()?c.last_name.trim()?c.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c.email)?c.commission_rate<0||c.commission_rate>100?(x(t("staff.errors.commissionRateInvalid")),!1):!0:(x(t("staff.errors.validEmailRequired")),!1):(x(t("staff.errors.emailRequired")),!1):(x(t("staff.errors.lastNameRequired")),!1):(x(t("staff.errors.firstNameRequired")),!1),B=async a=>{if(a.preventDefault(),x(""),!!k()){C(!0);try{const i={...c,business_id:r.id,working_hours:v};let s;o?s=await me(o.id,i):s=await be(i),s.error?x(s.error):n(s.data)}catch(i){x(i.message||t("staff.errors.genericError"))}finally{C(!1)}}},U={monday:t("staff.days.monday"),tuesday:t("staff.days.tuesday"),wednesday:t("staff.days.wednesday"),thursday:t("staff.days.thursday"),friday:t("staff.days.friday"),saturday:t("staff.days.saturday"),sunday:t("staff.days.sunday")},l=[{value:q.manager,label:t("staff.roles.manager")},{value:q.reception,label:t("staff.roles.reception")},{value:q.senior_employee,label:t("staff.roles.seniorEmployee")},{value:q.junior_employee,label:t("staff.roles.juniorEmployee")}];return e.jsx(S,{children:e.jsx(f,{xs:12,children:e.jsxs(I,{className:"mb-4",children:[e.jsx(ce,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"mb-0",children:t(o?"staff.form.editStaff":"staff.form.addNewStaff")}),e.jsxs(Z,{color:"light",onClick:_,disabled:m,children:[e.jsx(g,{icon:je,className:"me-2"}),t("staff.form.back")]})]})}),e.jsxs(O,{children:[M&&e.jsx(P,{color:"danger",dismissible:!0,onClose:()=>x(""),children:M}),e.jsxs(Me,{onSubmit:B,children:[e.jsxs(S,{children:[e.jsx(f,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(L,{htmlFor:"first_name",children:[t("staff.form.firstName")," *"]}),e.jsxs(X,{children:[e.jsx(le,{children:e.jsx(g,{icon:fe})}),e.jsx(T,{type:"text",id:"first_name",placeholder:t("staff.form.firstNamePlaceholder"),value:c.first_name,onChange:a=>b("first_name",a.target.value),required:!0,disabled:m})]})]})}),e.jsx(f,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(L,{htmlFor:"last_name",children:[t("staff.form.lastName")," *"]}),e.jsxs(X,{children:[e.jsx(le,{children:e.jsx(g,{icon:fe})}),e.jsx(T,{type:"text",id:"last_name",placeholder:t("staff.form.lastNamePlaceholder"),value:c.last_name,onChange:a=>b("last_name",a.target.value),required:!0,disabled:m})]})]})})]}),e.jsxs(S,{children:[e.jsx(f,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(L,{htmlFor:"email",children:[t("staff.form.email")," *"]}),e.jsx(T,{type:"email",id:"email",placeholder:t("staff.form.emailPlaceholder"),value:c.email,onChange:a=>b("email",a.target.value),required:!0,disabled:m||o}),o&&e.jsx("small",{className:"text-muted",children:t("staff.form.emailCannotChange")})]})}),e.jsx(f,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(L,{htmlFor:"phone",children:t("staff.form.phone")}),e.jsxs(X,{children:[e.jsx(le,{children:e.jsx(g,{icon:ue})}),e.jsx(T,{type:"tel",id:"phone",placeholder:t("staff.form.phonePlaceholder"),value:c.phone,onChange:a=>b("phone",a.target.value),disabled:m})]})]})})]}),e.jsxs(S,{children:[e.jsx(f,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsxs(L,{htmlFor:"role",children:[t("staff.form.role")," *"]}),e.jsx(ne,{id:"role",value:c.role,onChange:a=>b("role",a.target.value),required:!0,disabled:m,children:l.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]})}),e.jsx(f,{md:6,children:e.jsxs("div",{className:"mb-3",children:[e.jsx(L,{htmlFor:"commission_rate",children:t("staff.form.commissionRate")}),e.jsx(T,{type:"number",id:"commission_rate",min:"0",max:"100",step:"0.1",value:c.commission_rate,onChange:a=>b("commission_rate",parseFloat(a.target.value)||0),disabled:m})]})})]}),e.jsx(S,{className:"mb-4",children:e.jsx(f,{xs:12,children:e.jsx(ie,{id:"is_available_for_booking",checked:c.is_available_for_booking,onChange:a=>b("is_available_for_booking",a.target.checked),label:t("staff.form.availableForBooking"),disabled:m})})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{children:t("staff.form.assignedServices")}),E?e.jsx("div",{className:"text-center py-4",children:e.jsx(se,{})}):R.length===0?e.jsx(P,{color:"info",children:t("staff.form.noServicesAvailable")}):e.jsx("div",{className:"border rounded p-3",children:R.map(a=>e.jsx(ie,{id:`service-${a.id}`,checked:c.service_ids.includes(a.id),onChange:()=>G(a.id),label:`${a.name} - ${a.duration_minutes} min - ${a.price} PLN`,disabled:m,className:"mb-2"},a.id))})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{children:t("staff.form.workingHours")}),Object.entries(U).map(([a,i])=>{var s,d,y,W,de;return e.jsxs(S,{className:"mb-2 align-items-center",children:[e.jsx(f,{md:2,children:e.jsx(L,{className:"mb-0",children:i})}),e.jsx(f,{md:2,children:e.jsx(ie,{checked:((s=v[a])==null?void 0:s.available)!==!1,onChange:J=>F(a,"available",J.target.checked),label:t("staff.form.available"),disabled:m})}),e.jsx(f,{md:3,children:e.jsx(T,{type:"time",value:((d=v[a])==null?void 0:d.start)||"09:00",onChange:J=>F(a,"start",J.target.value),disabled:m||!((y=v[a])!=null&&y.available)})}),e.jsx(f,{md:3,children:e.jsx(T,{type:"time",value:((W=v[a])==null?void 0:W.end)||"17:00",onChange:J=>F(a,"end",J.target.value),disabled:m||!((de=v[a])!=null&&de.available)})})]},a)})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx(Z,{type:"button",color:"secondary",onClick:_,disabled:m,children:t("staff.form.cancel")}),e.jsx(Z,{type:"submit",color:"primary",disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(se,{size:"sm",className:"me-2"}),t(o?"staff.form.updating":"staff.form.creating")]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{icon:He,className:"me-2"}),t(o?"staff.form.updateStaff":"staff.form.createStaff")]})})]})]})]})]})})})};pe.propTypes={staff:z.object,onClose:z.func.isRequired,onSuccess:z.func.isRequired};const ge=({staffId:o,onBack:_,onEdit:n})=>{const{t:r}=oe(),[t,m]=h.useState(null),[C,M]=h.useState([]),[x,R]=h.useState(null),[H,E]=h.useState(!0),[N,c]=h.useState(""),[p,v]=h.useState("details");h.useEffect(()=>{o&&D()},[o]),h.useEffect(()=>{p==="schedule"&&t?V():p==="performance"&&t&&b()},[p,t]);const D=async()=>{E(!0),c("");try{const{data:l,error:a}=await Se(o);a?c(a):m(l)}catch(l){c(l.message)}finally{E(!1)}},V=async()=>{const l=new Date,a=l.toISOString().split("T")[0],i=new Date(l.getTime()+336*60*60*1e3).toISOString().split("T")[0];try{const{data:s,error:d}=await Ce(o,a,i);d?c(d):M(s||[])}catch(s){c(s.message)}},b=async()=>{const l=new Date,a=new Date(l.getTime()-720*60*60*1e3).toISOString().split("T")[0],i=l.toISOString().split("T")[0];try{const{data:s,error:d}=await Ne(o,a,i);d?c(d):R(s)}catch(s){c(s.message)}},G=l=>{const i={active:{color:"success",text:r("staff.status.active")},invited:{color:"warning",text:r("staff.status.invited")},inactive:{color:"secondary",text:r("staff.status.inactive")},terminated:{color:"danger",text:r("staff.status.terminated")}}[l]||{color:"secondary",text:l};return e.jsx(A,{color:i.color,children:i.text})},F=l=>{const i={owner:{color:"primary",text:r("staff.roles.owner")},manager:{color:"info",text:r("staff.roles.manager")},reception:{color:"success",text:r("staff.roles.reception")},senior_employee:{color:"warning",text:r("staff.roles.seniorEmployee")},junior_employee:{color:"secondary",text:r("staff.roles.juniorEmployee")}}[l]||{color:"secondary",text:l};return e.jsx(A,{color:i.color,children:i.text})},k=l=>new Date(`2000-01-01T${l}`).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),B=l=>new Date(l).toLocaleDateString(),U=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];return H?e.jsx("div",{className:"text-center p-4",children:e.jsx(se,{})}):N?e.jsx(P,{color:"danger",children:N}):t?e.jsx(S,{children:e.jsx(f,{xs:12,children:e.jsxs(I,{className:"mb-4",children:[e.jsx(ce,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"mb-0",children:r("staff.details.title")}),e.jsxs("div",{children:[e.jsxs(Z,{color:"primary",size:"sm",className:"me-2",onClick:()=>n(t),children:[e.jsx(g,{icon:xe,className:"me-2"}),r("staff.actions.edit")]}),e.jsxs(Z,{color:"secondary",variant:"ghost",onClick:_,children:[e.jsx(g,{icon:je,className:"me-2"}),r("staff.form.back")]})]})]})}),e.jsxs(O,{children:[e.jsxs(we,{variant:"tabs",className:"mb-3",children:[e.jsx(ae,{children:e.jsx(te,{active:p==="details",onClick:()=>v("details"),style:{cursor:"pointer"},children:r("staff.details.tabs.details")})}),e.jsx(ae,{children:e.jsxs(te,{active:p==="schedule",onClick:()=>v("schedule"),style:{cursor:"pointer"},children:[e.jsx(g,{icon:Fe,className:"me-2"}),r("staff.details.tabs.schedule")]})}),e.jsx(ae,{children:e.jsxs(te,{active:p==="performance",onClick:()=>v("performance"),style:{cursor:"pointer"},children:[e.jsx(g,{icon:ke,className:"me-2"}),r("staff.details.tabs.performance")]})})]}),e.jsxs(Te,{children:[e.jsx(re,{visible:p==="details",children:e.jsxs(S,{children:[e.jsxs(f,{md:6,children:[e.jsx("h5",{children:r("staff.details.personalInfo")}),e.jsx("table",{className:"table table-borderless",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[r("staff.details.name"),":"]})}),e.jsxs("td",{children:[t.first_name," ",t.last_name]})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[r("staff.details.email"),":"]})}),e.jsx("td",{children:t.email})]}),t.phone&&e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[r("staff.details.phone"),":"]})}),e.jsxs("td",{children:[e.jsx(g,{icon:ue,className:"me-2"}),t.phone]})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[r("staff.details.role"),":"]})}),e.jsx("td",{children:F(t.role)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[r("staff.details.status"),":"]})}),e.jsx("td",{children:G(t.status)})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[r("staff.details.commissionRate"),":"]})}),e.jsxs("td",{children:[t.commission_rate,"%"]})]}),e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[r("staff.details.availableForBooking"),":"]})}),e.jsx("td",{children:e.jsx(A,{color:t.is_available_for_booking?"success":"secondary",children:t.is_available_for_booking?r("staff.details.yes"):r("staff.details.no")})})]}),t.joined_at&&e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[r("staff.details.joined"),":"]})}),e.jsx("td",{children:B(t.joined_at)})]})]})})]}),e.jsxs(f,{md:6,children:[e.jsx("h5",{children:r("staff.details.workingHours")}),e.jsxs(Q,{small:!0,children:[e.jsx(Y,{children:e.jsxs(w,{children:[e.jsx(u,{children:r("staff.details.day")}),e.jsx(u,{children:r("staff.details.hours")})]})}),e.jsx(ee,{children:t.working_hours&&U.map(l=>{const a=t.working_hours[l];return a?e.jsxs(w,{children:[e.jsx(j,{className:"text-capitalize",children:r(`staff.days.${l}`)}),e.jsx(j,{children:a.available===!1?e.jsx(A,{color:"secondary",children:r("staff.details.notWorking")}):`${k(a.start)} - ${k(a.end)}`})]},l):null})})]}),t.employee_services&&t.employee_services.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("h5",{className:"mt-4",children:r("staff.details.assignedServices")}),e.jsxs(Q,{small:!0,children:[e.jsx(Y,{children:e.jsxs(w,{children:[e.jsx(u,{children:r("staff.details.service")}),e.jsx(u,{children:r("staff.details.price")}),e.jsx(u,{children:r("staff.details.duration")})]})}),e.jsx(ee,{children:t.employee_services.map(l=>{var a,i,s;return e.jsxs(w,{children:[e.jsx(j,{children:(a=l.services)==null?void 0:a.name}),e.jsxs(j,{children:["PLN ",(i=l.services)==null?void 0:i.price]}),e.jsxs(j,{children:[(s=l.services)==null?void 0:s.duration_minutes," min"]})]},l.id)})})]})]})]})]})}),e.jsxs(re,{visible:p==="schedule",children:[e.jsx("h5",{children:r("staff.details.schedule.title")}),C.length===0?e.jsx(P,{color:"info",children:r("staff.details.schedule.noAppointments")}):e.jsxs(Q,{hover:!0,children:[e.jsx(Y,{children:e.jsxs(w,{children:[e.jsx(u,{children:r("staff.details.schedule.date")}),e.jsx(u,{children:r("staff.details.schedule.time")}),e.jsx(u,{children:r("staff.details.schedule.client")}),e.jsx(u,{children:r("staff.details.schedule.service")}),e.jsx(u,{children:r("staff.details.schedule.duration")}),e.jsx(u,{children:r("staff.details.schedule.status")})]})}),e.jsx(ee,{children:C.map(l=>{var a,i,s;return e.jsxs(w,{children:[e.jsx(j,{children:B(l.appointment_date)}),e.jsx(j,{children:k(l.start_time)}),e.jsxs(j,{children:[(a=l.clients)==null?void 0:a.first_name," ",(i=l.clients)==null?void 0:i.last_name]}),e.jsx(j,{children:(s=l.services)==null?void 0:s.name}),e.jsxs(j,{children:[l.duration_minutes," min"]}),e.jsx(j,{children:e.jsx(A,{color:l.status==="completed"?"success":"primary",children:l.status})})]},l.id)})})]})]}),e.jsxs(re,{visible:p==="performance",children:[e.jsx("h5",{children:r("staff.details.performance.title")}),x?e.jsxs(S,{children:[e.jsx(f,{md:3,children:e.jsx(I,{className:"text-center",children:e.jsxs(O,{children:[e.jsx("h4",{className:"text-primary",children:x.total_appointments}),e.jsx("p",{className:"text-muted mb-0",children:r("staff.details.performance.totalAppointments")})]})})}),e.jsx(f,{md:3,children:e.jsx(I,{className:"text-center",children:e.jsxs(O,{children:[e.jsx("h4",{className:"text-success",children:x.completed_appointments}),e.jsx("p",{className:"text-muted mb-0",children:r("staff.details.performance.completed")})]})})}),e.jsx(f,{md:3,children:e.jsx(I,{className:"text-center",children:e.jsxs(O,{children:[e.jsxs("h4",{className:"text-info",children:[x.completion_rate.toFixed(1),"%"]}),e.jsx("p",{className:"text-muted mb-0",children:r("staff.details.performance.completionRate")})]})})}),e.jsx(f,{md:3,children:e.jsx(I,{className:"text-center",children:e.jsxs(O,{children:[e.jsxs("h4",{className:"text-warning",children:["PLN ",x.total_revenue.toFixed(2)]}),e.jsx("p",{className:"text-muted mb-0",children:r("staff.details.performance.totalRevenue")})]})})})]}):e.jsx(P,{color:"info",children:r("staff.details.performance.loading")})]})]})]})]})})}):e.jsx(P,{color:"warning",children:r("staff.errors.staffNotFound")})};ge.propTypes={staffId:z.string.isRequired,onBack:z.func.isRequired,onEdit:z.func.isRequired};const rs=()=>{const o=ve(),{business:_}=he(),{t:n}=oe(),{staff:r,loading:t,error:m,filters:C}=ye(s=>s.staff),[M,x]=h.useState(!1),[R,H]=h.useState(null),[E,N]=h.useState(null),[c,p]=h.useState("");h.useEffect(()=>{_!=null&&_.id&&v()},[_==null?void 0:_.id,C]);const v=async()=>{console.log("[todo loadStaff()]"),o({type:"STAFF_LOADING"});try{const{data:s,error:d}=await Re(_.id,C);console.log("[todo loadStaff()] getStaff ",{data:s,error:d}),d?(console.log("[todo loadStaff] STAFF_ERROR"),o({type:"STAFF_ERROR",payload:d})):(console.log("[todo loadStaff] STAFF_SUCCESS"),o({type:"STAFF_SUCCESS",payload:s||[]}))}catch(s){o({type:"STAFF_ERROR",payload:s.message})}},D=(s,d)=>{o({type:"SET_STAFF_FILTERS",payload:{[s]:d}})},V=s=>{N(s)},b=s=>{H(s),x(!0)},G=async s=>{if(window.confirm(n("staff.confirmDelete")))try{const{error:d}=await Pe(s);o(d?{type:"STAFF_ERROR",payload:d}:{type:"REMOVE_STAFF",payload:s})}catch(d){o({type:"STAFF_ERROR",payload:d.message})}},F=async(s,d)=>{try{const{data:y,error:W}=await me(s,{status:d});o(W?{type:"STAFF_ERROR",payload:W}:{type:"UPDATE_STAFF",payload:y})}catch(y){o({type:"STAFF_ERROR",payload:y.message})}},k=()=>{x(!1),H(null)},B=()=>{N(null)},U=async s=>{R?await v():o({type:"ADD_STAFF",payload:s}),k()},l=s=>{const y={active:{color:"success",text:n("staff.status.active")},invited:{color:"warning",text:n("staff.status.invited")},inactive:{color:"secondary",text:n("staff.status.inactive")},terminated:{color:"danger",text:n("staff.status.terminated")}}[s]||{color:"secondary",text:s};return e.jsx(A,{color:y.color,children:y.text})},a=s=>{const y={owner:{color:"primary",text:n("staff.roles.owner")},manager:{color:"info",text:n("staff.roles.manager")},reception:{color:"success",text:n("staff.roles.reception")},senior_employee:{color:"warning",text:n("staff.roles.seniorEmployee")},junior_employee:{color:"secondary",text:n("staff.roles.juniorEmployee")}}[s]||{color:"secondary",text:s};return e.jsx(A,{color:y.color,children:y.text})},i=r.filter(s=>s.first_name.toLowerCase().includes(c.toLowerCase())||s.last_name.toLowerCase().includes(c.toLowerCase())||s.email.toLowerCase().includes(c.toLowerCase()));return E?e.jsx(ge,{staffId:E.id,onBack:B,onEdit:s=>{N(null),b(s)}}):M?e.jsx(pe,{staff:R,onClose:k,onSuccess:U}):e.jsx(S,{children:e.jsx(f,{xs:12,children:e.jsxs(I,{className:"mb-4",children:[e.jsx(ce,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"mb-0",children:n("staff.title")}),e.jsxs(Z,{color:"primary",onClick:()=>x(!0),children:[e.jsx(g,{icon:Ee,className:"me-2"}),n("staff.addStaff")]})]})}),e.jsxs(O,{children:[m&&e.jsx(P,{color:"danger",dismissible:!0,children:m}),e.jsxs(S,{className:"mb-3",children:[e.jsx(f,{md:4,children:e.jsx(X,{children:e.jsx(T,{placeholder:n("staff.searchPlaceholder"),value:c,onChange:s=>p(s.target.value)})})}),e.jsx(f,{md:3,children:e.jsxs(ne,{value:C.status,onChange:s=>D("status",s.target.value),children:[e.jsx("option",{value:"all",children:n("staff.filters.allStatus")}),e.jsx("option",{value:"active",children:n("staff.status.active")}),e.jsx("option",{value:"invited",children:n("staff.status.invited")}),e.jsx("option",{value:"inactive",children:n("staff.status.inactive")}),e.jsx("option",{value:"terminated",children:n("staff.status.terminated")})]})}),e.jsx(f,{md:3,children:e.jsxs(ne,{value:C.role,onChange:s=>D("role",s.target.value),children:[e.jsx("option",{value:"all",children:n("staff.filters.allRoles")}),e.jsx("option",{value:"manager",children:n("staff.roles.manager")}),e.jsx("option",{value:"reception",children:n("staff.roles.reception")}),e.jsx("option",{value:"senior_employee",children:n("staff.roles.seniorEmployee")}),e.jsx("option",{value:"junior_employee",children:n("staff.roles.juniorEmployee")})]})})]}),t?e.jsx("div",{className:"text-center p-4",children:e.jsx(se,{})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{overflowX:"auto",minHeight:"400px"},children:e.jsxs(Q,{hover:!0,children:[e.jsx(Y,{children:e.jsxs(w,{children:[e.jsx(u,{children:n("staff.table.name")}),e.jsx(u,{children:n("staff.table.email")}),e.jsx(u,{children:n("staff.table.role")}),e.jsx(u,{children:n("staff.table.status")}),e.jsx(u,{children:n("staff.table.commission")}),e.jsx(u,{style:{width:"80px"},children:n("staff.table.actions")})]})}),e.jsx(ee,{children:i.length===0?e.jsx(w,{children:e.jsx(j,{colSpan:"6",className:"text-center",children:n("staff.noStaffFound")})}):i.map(s=>e.jsxs(w,{children:[e.jsx(j,{children:e.jsxs("strong",{children:[s.first_name," ",s.last_name]})}),e.jsx(j,{children:s.email}),e.jsx(j,{children:a(s.role)}),e.jsx(j,{children:l(s.status)}),e.jsxs(j,{children:[s.commission_rate,"%"]}),e.jsx(j,{children:e.jsxs(De,{alignment:"end",direction:"up",children:[e.jsx(Le,{size:"sm",color:"ghost",children:e.jsx(g,{icon:Be})}),e.jsxs(Ae,{children:[e.jsxs($,{onClick:()=>V(s),children:[e.jsx(g,{icon:qe,className:"me-2"}),n("staff.actions.viewDetails")]}),e.jsxs($,{onClick:()=>b(s),children:[e.jsx(g,{icon:xe,className:"me-2"}),n("staff.actions.edit")]}),s.status==="invited"&&e.jsxs($,{children:[e.jsx(g,{icon:Ie,className:"me-2"}),n("staff.actions.resendInvitation")]}),s.status==="active"&&e.jsx($,{onClick:()=>F(s.id,"inactive"),children:n("staff.actions.deactivate")}),s.status==="inactive"&&e.jsx($,{onClick:()=>F(s.id,"active"),children:n("staff.actions.activate")}),e.jsxs($,{className:"text-danger",onClick:()=>G(s.id),children:[e.jsx(g,{icon:Oe,className:"me-2"}),n("staff.actions.delete")]})]})]})})]},s.id))})]})}),i.length>0&&e.jsx("div",{className:"text-center text-muted py-3",style:{fontSize:"0.875rem",borderTop:"1px solid #d8dbe0"},children:n("staff.endOfList",{count:i.length,plural:i.length!==1?"s":""})})]})]})]})})})};export{rs as default};
