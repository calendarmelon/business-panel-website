import{j as e,C as P,P as v,u as K}from"./index-DMjyWb87.js";import{a as u}from"./vendor-39lPmIfa.js";import{a as W,u as Q}from"./redux-B4nc4lEw.js";import{a as C,b as g,c as y}from"./index.esm-Li650mXS.js";import{d as M,g as X,C as L,B as Y,D as ee,E as se,F,s as ae,H as le,i as ie,j as re,k as ne,l as te,J as oe,K as ce,L as de,M as me}from"./DefaultLayout-D0SvWDL6.js";import{a as Z,b as he,c as D,d as I,e as R}from"./useLocale-D5KkehiU.js";import{b as p,c as o,a as A}from"./CRow-D_VJqXdr.js";import{C as w,a as xe,b as Ce,c as B,d as j,e as je,f}from"./CTable-8066dvqR.js";import{C as fe}from"./CCardHeader-B4dk8NaO.js";import{C as pe}from"./CInputGroup-DyS8gjpD.js";import{C as ue}from"./CInputGroupText-CLTmAy_-.js";import{c as be}from"./cil-options-sHCm5Gxk.js";var _e=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M425.706,86.294A240,240,0,0,0,86.294,425.705,240,240,0,0,0,425.706,86.294ZM256,48A207.1,207.1,0,0,1,391.528,98.345L98.345,391.528A207.1,207.1,0,0,1,48,256C48,141.309,141.309,48,256,48Zm0,416a207.084,207.084,0,0,1-134.986-49.887l293.1-293.1A207.084,207.084,0,0,1,464,256C464,370.691,370.691,464,256,464Z' class='ci-primary'/>"],ye=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M426.072,86.928A238.75,238.75,0,0,0,88.428,424.572,238.75,238.75,0,0,0,426.072,86.928ZM257.25,462.5c-114,0-206.75-92.748-206.75-206.75S143.248,49,257.25,49,464,141.748,464,255.75,371.252,462.5,257.25,462.5Z' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='221.27 305.808 147.857 232.396 125.23 255.023 221.27 351.063 388.77 183.564 366.142 160.937 221.27 305.808' class='ci-primary'/>"],ge=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M479.6,399.716l-81.084-81.084-62.368-25.767A175.014,175.014,0,0,0,368,192c0-97.047-78.953-176-176-176S16,94.953,16,192,94.953,368,192,368a175.034,175.034,0,0,0,101.619-32.377l25.7,62.2L400.4,478.911a56,56,0,1,0,79.2-79.195ZM48,192c0-79.4,64.6-144,144-144s144,64.6,144,144S271.4,336,192,336,48,271.4,48,192ZM456.971,456.284a24.028,24.028,0,0,1-33.942,0l-76.572-76.572-23.894-57.835L380.4,345.771l76.573,76.572A24.028,24.028,0,0,1,456.971,456.284Z' class='ci-primary'/>"],Ne=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M208,16A112.127,112.127,0,0,0,96,128v79.681a80.236,80.236,0,0,0,9.768,38.308l27.455,50.333L60.4,343.656A79.725,79.725,0,0,0,24,410.732V496H312V464H56V410.732a47.836,47.836,0,0,1,21.841-40.246l97.66-63.479-41.64-76.341A48.146,48.146,0,0,1,128,207.681V128a80,80,0,0,1,160,0v79.681a48.146,48.146,0,0,1-5.861,22.985L240.5,307.007,312,353.483V315.317l-29.223-19,27.455-50.334A80.23,80.23,0,0,0,320,207.681V128A112.127,112.127,0,0,0,208,16Z' class='ci-primary'/><polygon fill='var(--ci-primary-color, currentColor)' points='424 400 424 336 392 336 392 400 328 400 328 432 392 432 392 496 424 496 424 432 488 432 488 400 424 400' class='ci-primary'/>"];const ve=(l,m)=>{const a="example.com",i=Date.now();return`${l.toLowerCase()}.${m.toLowerCase()}.${i}@${a}`},ke={first_name:"John",last_name:"Doe",email:ve("John","Doe"),phone:"",date_of_birth:"1990-01-01",notes:"",allergies:"",email_notifications:!0,sms_notifications:!0,marketing_emails:!0},H=({client:l,onSubmit:m,onCancel:a,loading:i,error:N})=>{const{t:r}=Z(),[t,k]=u.useState(ke);u.useEffect(()=>{l&&k({first_name:l.first_name||"",last_name:l.last_name||"",email:l.email||"",phone:l.phone||"",date_of_birth:l.date_of_birth||"",notes:l.notes||"",allergies:l.allergies||"",email_notifications:l.email_notifications??!0,sms_notifications:l.sms_notifications??!0,marketing_emails:l.marketing_emails??!0})},[l]);const n=b=>{const{name:E,value:S,type:T,checked:_}=b.target;k(x=>({...x,[E]:T==="checkbox"?_:S}))},h=b=>{b.preventDefault(),m(t)};return e.jsxs(he,{onSubmit:h,children:[N&&e.jsx(D,{color:"danger",className:"mb-3",children:N}),e.jsxs(p,{className:"mb-3",children:[e.jsxs(o,{md:6,children:[e.jsxs(C,{htmlFor:"first_name",children:[r("clients.form.firstName")," *"]}),e.jsx(g,{id:"first_name",name:"first_name",value:t.first_name,onChange:n,required:!0,disabled:i})]}),e.jsxs(o,{md:6,children:[e.jsxs(C,{htmlFor:"last_name",children:[r("clients.form.lastName")," *"]}),e.jsx(g,{id:"last_name",name:"last_name",value:t.last_name,onChange:n,required:!0,disabled:i})]})]}),e.jsxs(p,{className:"mb-3",children:[e.jsxs(o,{md:6,children:[e.jsx(C,{htmlFor:"email",children:r("clients.form.email")}),e.jsx(g,{id:"email",name:"email",type:"email",value:t.email,onChange:n,disabled:i})]}),e.jsxs(o,{md:6,children:[e.jsx(C,{htmlFor:"phone",children:r("clients.form.phone")}),e.jsx(g,{id:"phone",name:"phone",type:"tel",value:t.phone,onChange:n,disabled:i})]})]}),e.jsx(p,{className:"mb-3",children:e.jsxs(o,{md:6,children:[e.jsx(C,{htmlFor:"date_of_birth",children:r("clients.form.dateOfBirth")}),e.jsx(g,{id:"date_of_birth",name:"date_of_birth",type:"date",value:t.date_of_birth,onChange:n,disabled:i})]})}),e.jsx(p,{className:"mb-3",children:e.jsxs(o,{children:[e.jsx(C,{htmlFor:"notes",children:r("clients.form.notes")}),e.jsx(M,{id:"notes",name:"notes",rows:"3",value:t.notes,onChange:n,disabled:i})]})}),e.jsx(p,{className:"mb-3",children:e.jsxs(o,{children:[e.jsx(C,{htmlFor:"allergies",children:r("clients.form.allergies")}),e.jsx(M,{id:"allergies",name:"allergies",rows:"2",value:t.allergies,onChange:n,disabled:i})]})}),e.jsxs(p,{className:"mb-3",children:[e.jsx(o,{children:e.jsx(w,{id:"email_notifications",name:"email_notifications",label:r("clients.form.emailNotifications"),checked:t.email_notifications,onChange:n,disabled:i})}),e.jsx(o,{children:e.jsx(w,{id:"sms_notifications",name:"sms_notifications",label:r("clients.form.smsNotifications"),checked:t.sms_notifications,onChange:n,disabled:i})}),e.jsx(o,{children:e.jsx(w,{id:"marketing_emails",name:"marketing_emails",label:r("clients.form.marketingEmails"),checked:t.marketing_emails,onChange:n,disabled:i})})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx(A,{color:"secondary",onClick:a,disabled:i,children:r("clients.form.cancel")}),e.jsx(A,{color:"primary",type:"submit",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx(P,{size:"sm",className:"me-2"}),r("clients.form.saving")]}):r(l?"clients.form.updateClient":"clients.form.addClient")})]})]})};H.propTypes={client:v.object,onSubmit:v.func.isRequired,onCancel:v.func.isRequired,loading:v.bool,error:v.string};const Pe=()=>{const l=W(),{business:m}=K(),{t:a}=Z(),{clients:i,loading:N,error:r,filters:t}=Q(s=>s.clients),[k,n]=u.useState(!1),[h,b]=u.useState(null),[E,S]=u.useState(!1),[T,_]=u.useState(null),x=m==null?void 0:m.id;u.useEffect(()=>{x&&O()},[x,t]);const O=async()=>{l({type:"CLIENTS_LOADING"});const{data:s,error:c}=await X(x,t);l(c?{type:"CLIENTS_ERROR",payload:c}:{type:"CLIENTS_SUCCESS",payload:s||[]})},V=s=>{l({type:"SET_CLIENT_FILTERS",payload:{search:s.target.value}})},$=()=>{b(null),_(null),n(!0)},q=s=>{b(s),_(null),n(!0)},U=async s=>{if(window.confirm(a("clients.confirmDelete"))){const{error:c}=await ce(s);c?alert(a("clients.errors.deletingClient")+c):l({type:"REMOVE_CLIENT",payload:s})}},z=async s=>{const{data:c,error:d}=await oe(s.id,!s.is_blocked);d?alert(a("clients.errors.updatingClient")+d):l({type:"UPDATE_CLIENT",payload:c})},G=async s=>{S(!0),_(null);const c={...s,business_id:x};let d;h?d=await de(h.id,c):d=await me(c),S(!1),d.error?_(d.error):(l(h?{type:"UPDATE_CLIENT",payload:d.data}:{type:"ADD_CLIENT",payload:d.data}),n(!1))},J=s=>s||"-";return x?e.jsxs(e.Fragment,{children:[e.jsxs(I,{className:"mb-4",children:[e.jsxs(fe,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:a("clients.title")}),e.jsxs(A,{color:"primary",onClick:$,children:[e.jsx(y,{icon:Ne,className:"me-2"}),a("clients.addClient")]})]}),e.jsxs(R,{children:[e.jsx(p,{className:"mb-3",children:e.jsx(o,{md:6,children:e.jsxs(pe,{children:[e.jsx(ue,{children:e.jsx(y,{icon:ge})}),e.jsx(g,{placeholder:a("clients.searchPlaceholder"),value:t.search,onChange:V})]})})}),r&&e.jsx(D,{color:"danger",className:"mb-3",children:r}),N?e.jsx("div",{className:"text-center py-5",children:e.jsx(P,{color:"primary"})}):i.length===0?e.jsx("div",{className:"text-center py-5 text-muted",children:a("clients.noClientsFound")}):e.jsxs(xe,{hover:!0,responsive:!0,children:[e.jsx(Ce,{children:e.jsxs(B,{children:[e.jsx(j,{children:a("clients.table.name")}),e.jsx(j,{children:a("clients.table.email")}),e.jsx(j,{children:a("clients.table.phone")}),e.jsx(j,{children:a("clients.table.bookings")}),e.jsx(j,{children:a("clients.table.totalSpent")}),e.jsx(j,{children:a("clients.table.status")}),e.jsx(j,{children:a("clients.table.actions")})]})}),e.jsx(je,{children:i.map(s=>e.jsxs(B,{children:[e.jsx(f,{children:e.jsxs("strong",{children:[s.first_name," ",s.last_name]})}),e.jsx(f,{children:s.email||"-"}),e.jsx(f,{children:J(s.phone)}),e.jsx(f,{children:s.total_bookings||0}),e.jsx(f,{children:s.total_spent?`${s.total_spent.toFixed(2)} PLN`:"0.00 PLN"}),e.jsx(f,{children:s.is_blocked?e.jsx(L,{color:"danger",children:a("clients.status.blocked")}):s.is_active?e.jsx(L,{color:"success",children:a("clients.status.active")}):e.jsx(L,{color:"secondary",children:a("clients.status.inactive")})}),e.jsx(f,{children:e.jsxs(Y,{children:[e.jsx(ee,{color:"light",size:"sm",children:e.jsx(y,{icon:be})}),e.jsxs(se,{children:[e.jsxs(F,{onClick:()=>q(s),children:[e.jsx(y,{icon:ae,className:"me-2"}),a("clients.actions.edit")]}),e.jsxs(F,{onClick:()=>z(s),children:[e.jsx(y,{icon:s.is_blocked?ye:_e,className:"me-2"}),s.is_blocked?a("clients.actions.unblock"):a("clients.actions.block")]}),e.jsxs(F,{className:"text-danger",onClick:()=>U(s.id),children:[e.jsx(y,{icon:le,className:"me-2"}),a("clients.actions.delete")]})]})]})})]},s.id))})]})]})]}),e.jsxs(ie,{visible:k,onClose:()=>n(!1),size:"lg",children:[e.jsx(re,{children:e.jsx(ne,{children:a(h?"clients.modal.editClient":"clients.modal.addNewClient")})}),e.jsx(te,{children:e.jsx(H,{client:h,onSubmit:G,onCancel:()=>n(!1),loading:E,error:T})})]})]}):e.jsx(I,{children:e.jsx(R,{children:e.jsx(D,{color:"warning",children:a("clients.noBusinessWarning")})})})};export{Pe as default};
